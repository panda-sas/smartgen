# E-Commerce Domain Example

This example demonstrates a complete e-commerce domain generated by SmartGen, including user management, product catalog, shopping cart, and order processing.

## Overview

This example shows how SmartGen generates DDD-compliant domain code from a Software Requirements Specification (SRS). The generated code follows Clean Architecture principles and Domain-Driven Design patterns.

## Structure

```
examples/ecommerce/
├── srs.md                          # Software Requirements Specification
├── readme.md                       # This file
└── src/
    └── domain/
        ├── aggregates/
        │   └── order.py           # Order aggregate root
        ├── entities/
        │   ├── product.py         # Product entity
        │   └── user.py            # User entity
        └── value_objects/
            ├── address.py         # Address value object
            ├── email.py           # Email value object
            └── money.py           # Money value object
```

## Domain Model

### Value Objects

- **Email**: Validates email format, immutable
- **Money**: Represents currency amounts with precision, supports arithmetic
- **Address**: Represents shipping/billing addresses, immutable

### Entities

- **User**: Represents registered users (customers, admins, vendors)
  - Has identity (UserId)
  - Contains profile information
  - Supports role management

- **Product**: Represents catalog items
  - Has identity (ProductId)
  - Manages stock and pricing
  - Supports status (active/inactive)

### Aggregates

- **Order**: Order aggregate root
  - Contains OrderItems (value objects)
  - Manages order lifecycle (pending → confirmed → shipped → delivered)
  - Enforces business rules (cannot cancel shipped orders, etc.)
  - Contains shipping and billing addresses

## Key DDD Patterns Demonstrated

1. **Value Objects**: Email, Money, Address are immutable and validated
2. **Entities**: User and Product have identity and lifecycle
3. **Aggregates**: Order is an aggregate root with OrderItems as value objects
4. **Invariants**: Order enforces business rules (minimum items, total validation)
5. **Domain Events**: Structure supports events (not shown in this example)
6. **No Framework Dependencies**: Pure Python, no external dependencies in domain layer

## How This Was Generated

1. **SRS Created**: The `srs.md` file contains detailed requirements
2. **SmartGen Command**: `smartgen generate domain` was run
3. **LLM Processing**: SmartGen used an LLM (Ollama or OpenAI) to analyze the SRS
4. **Code Generation**: Domain code was generated following DDD policies
5. **Manual Review**: Generated code was reviewed and refined

## Usage Example

```python
from src.domain.value_objects.email import Email
from src.domain.value_objects.money import Money
from src.domain.entities.user import User, UserId, UserRole

# Create a user
user_id = UserId("user-123")
email = Email("customer@example.com")
user = User(
    user_id=user_id,
    email=email,
    password_hash="hashed_password",
    role=UserRole.CUSTOMER
)

# Update profile
user.update_profile(
    first_name="John",
    last_name="Doe"
)

# Create money value object
price = Money(29.99, "USD")
total = price.multiply(2)  # $59.98
```

## Business Rules Enforced

1. **Order Validation**: Orders must have at least one item
2. **Order Total**: Total must equal items + shipping + tax
3. **Order Status**: Status transitions follow strict rules
4. **Stock Management**: Products cannot have negative stock
5. **Email Validation**: Emails must be properly formatted
6. **Money Precision**: Money uses Decimal for precise calculations

## Next Steps

To use this domain in a real application, you would:

1. Generate the application layer (use cases)
2. Generate the infrastructure layer (repositories, persistence)
3. Generate the interface layer (API controllers, routes)
4. Implement the application services
5. Add persistence (database)
6. Add API endpoints

Run `smartgen generate layout` to generate the application structure.

## Learn More

- See the [main readme](../../readme.md) for SmartGen usage
- Check [examples.md](../../examples.md) for more examples
- Review [DDD policies](../../src/smartgen/policies/ddd/python/domain.txt) to understand generation rules
